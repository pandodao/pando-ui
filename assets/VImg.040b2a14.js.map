{"version":3,"file":"VImg.040b2a14.js","sources":["../../node_modules/vuetify/lib/components/VResponsive/VResponsive.mjs","../../node_modules/vuetify/lib/components/VImg/VImg.mjs"],"sourcesContent":["import { createVNode as _createVNode } from \"vue\";\n// Styles\nimport \"./VResponsive.css\";\n\n// Composables\nimport { makeDimensionProps, useDimension } from \"../../composables/dimensions.mjs\"; // Utilities\nimport { computed } from 'vue';\nimport { genericComponent, useRender } from \"../../util/index.mjs\";\nexport function useAspectStyles(props) {\n  return {\n    aspectStyles: computed(() => {\n      const ratio = Number(props.aspectRatio);\n      return ratio ? {\n        paddingBottom: String(1 / ratio * 100) + '%'\n      } : undefined;\n    })\n  };\n}\nexport const VResponsive = genericComponent()({\n  name: 'VResponsive',\n  props: {\n    aspectRatio: [String, Number],\n    contentClass: String,\n    ...makeDimensionProps()\n  },\n  setup(props, _ref) {\n    let {\n      slots\n    } = _ref;\n    const {\n      aspectStyles\n    } = useAspectStyles(props);\n    const {\n      dimensionStyles\n    } = useDimension(props);\n    useRender(() => _createVNode(\"div\", {\n      \"class\": \"v-responsive\",\n      \"style\": dimensionStyles.value\n    }, [_createVNode(\"div\", {\n      \"class\": \"v-responsive__sizer\",\n      \"style\": aspectStyles.value\n    }, null), slots.additional?.(), slots.default && _createVNode(\"div\", {\n      \"class\": ['v-responsive__content', props.contentClass]\n    }, [slots.default()])]));\n    return {};\n  }\n});\n//# sourceMappingURL=VResponsive.mjs.map","import { withDirectives as _withDirectives, resolveDirective as _resolveDirective, Fragment as _Fragment, createVNode as _createVNode } from \"vue\";\nimport \"./VImg.css\";\n\n// Components\nimport { VResponsive } from \"../VResponsive/index.mjs\"; // Directives\nimport intersect from \"../../directives/intersect/index.mjs\"; // Composables\nimport { makeTransitionProps, MaybeTransition } from \"../../composables/transition.mjs\"; // Utilities\nimport { computed, nextTick, onBeforeMount, ref, vShow, watch, withDirectives } from 'vue';\nimport { convertToUnit, genericComponent, SUPPORTS_INTERSECTION, useRender } from \"../../util/index.mjs\"; // Types\nexport const VImg = genericComponent()({\n  name: 'VImg',\n  directives: {\n    intersect\n  },\n  props: {\n    aspectRatio: [String, Number],\n    alt: String,\n    cover: Boolean,\n    eager: Boolean,\n    gradient: String,\n    lazySrc: String,\n    options: {\n      type: Object,\n      // For more information on types, navigate to:\n      // https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API\n      default: () => ({\n        root: undefined,\n        rootMargin: undefined,\n        threshold: undefined\n      })\n    },\n    sizes: String,\n    src: {\n      type: [String, Object],\n      default: ''\n    },\n    srcset: String,\n    width: [String, Number],\n    ...makeTransitionProps()\n  },\n  emits: {\n    loadstart: event => true,\n    load: event => true,\n    error: event => true\n  },\n  setup(props, _ref) {\n    let {\n      emit,\n      slots\n    } = _ref;\n    const currentSrc = ref(''); // Set from srcset\n    const image = ref();\n    const state = ref(props.eager ? 'loading' : 'idle');\n    const naturalWidth = ref();\n    const naturalHeight = ref();\n    const normalisedSrc = computed(() => {\n      return props.src && typeof props.src === 'object' ? {\n        src: props.src.src,\n        srcset: props.srcset || props.src.srcset,\n        lazySrc: props.lazySrc || props.src.lazySrc,\n        aspect: Number(props.aspectRatio || props.src.aspect || 0)\n      } : {\n        src: props.src,\n        srcset: props.srcset,\n        lazySrc: props.lazySrc,\n        aspect: Number(props.aspectRatio || 0)\n      };\n    });\n    const aspectRatio = computed(() => {\n      return normalisedSrc.value.aspect || naturalWidth.value / naturalHeight.value || 0;\n    });\n    watch(() => props.src, () => {\n      init(state.value !== 'idle');\n    });\n    watch(aspectRatio, (val, oldVal) => {\n      if (!val && oldVal && image.value) {\n        pollForSize(image.value);\n      }\n    });\n\n    // TODO: getSrc when window width changes\n\n    onBeforeMount(() => init());\n    function init(isIntersecting) {\n      if (props.eager && isIntersecting) return;\n      if (SUPPORTS_INTERSECTION && !isIntersecting && !props.eager) return;\n      state.value = 'loading';\n      if (normalisedSrc.value.lazySrc) {\n        const lazyImg = new Image();\n        lazyImg.src = normalisedSrc.value.lazySrc;\n        pollForSize(lazyImg, null);\n      }\n      if (!normalisedSrc.value.src) return;\n      nextTick(() => {\n        emit('loadstart', image.value?.currentSrc || normalisedSrc.value.src);\n        if (image.value?.complete) {\n          if (!image.value.naturalWidth) {\n            onError();\n          }\n          if (state.value === 'error') return;\n          if (!aspectRatio.value) pollForSize(image.value, null);\n          onLoad();\n        } else {\n          if (!aspectRatio.value) pollForSize(image.value);\n          getSrc();\n        }\n      });\n    }\n    function onLoad() {\n      getSrc();\n      state.value = 'loaded';\n      emit('load', image.value?.currentSrc || normalisedSrc.value.src);\n    }\n    function onError() {\n      state.value = 'error';\n      emit('error', image.value?.currentSrc || normalisedSrc.value.src);\n    }\n    function getSrc() {\n      const img = image.value;\n      if (img) currentSrc.value = img.currentSrc || img.src;\n    }\n    let timer = -1;\n    function pollForSize(img) {\n      let timeout = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 100;\n      const poll = () => {\n        clearTimeout(timer);\n        const {\n          naturalHeight: imgHeight,\n          naturalWidth: imgWidth\n        } = img;\n        if (imgHeight || imgWidth) {\n          naturalWidth.value = imgWidth;\n          naturalHeight.value = imgHeight;\n        } else if (!img.complete && state.value === 'loading' && timeout != null) {\n          timer = window.setTimeout(poll, timeout);\n        } else if (img.currentSrc.endsWith('.svg') || img.currentSrc.startsWith('data:image/svg+xml')) {\n          naturalWidth.value = 1;\n          naturalHeight.value = 1;\n        }\n      };\n      poll();\n    }\n    const containClasses = computed(() => ({\n      'v-img__img--cover': props.cover,\n      'v-img__img--contain': !props.cover\n    }));\n    const __image = () => {\n      if (!normalisedSrc.value.src || state.value === 'idle') return null;\n      const img = _createVNode(\"img\", {\n        \"class\": ['v-img__img', containClasses.value],\n        \"src\": normalisedSrc.value.src,\n        \"srcset\": normalisedSrc.value.srcset,\n        \"alt\": \"\",\n        \"sizes\": props.sizes,\n        \"ref\": image,\n        \"onLoad\": onLoad,\n        \"onError\": onError\n      }, null);\n      const sources = slots.sources?.();\n      return _createVNode(MaybeTransition, {\n        \"transition\": props.transition,\n        \"appear\": true\n      }, {\n        default: () => [withDirectives(sources ? _createVNode(\"picture\", {\n          \"class\": \"v-img__picture\"\n        }, [sources, img]) : img, [[vShow, state.value === 'loaded']])]\n      });\n    };\n    const __preloadImage = () => _createVNode(MaybeTransition, {\n      \"transition\": props.transition\n    }, {\n      default: () => [normalisedSrc.value.lazySrc && state.value !== 'loaded' && _createVNode(\"img\", {\n        \"class\": ['v-img__img', 'v-img__img--preload', containClasses.value],\n        \"src\": normalisedSrc.value.lazySrc,\n        \"alt\": \"\"\n      }, null)]\n    });\n    const __placeholder = () => {\n      if (!slots.placeholder) return null;\n      return _createVNode(MaybeTransition, {\n        \"transition\": props.transition,\n        \"appear\": true\n      }, {\n        default: () => [(state.value === 'loading' || state.value === 'error' && !slots.error) && _createVNode(\"div\", {\n          \"class\": \"v-img__placeholder\"\n        }, [slots.placeholder()])]\n      });\n    };\n    const __error = () => {\n      if (!slots.error) return null;\n      return _createVNode(MaybeTransition, {\n        \"transition\": props.transition,\n        \"appear\": true\n      }, {\n        default: () => [state.value === 'error' && _createVNode(\"div\", {\n          \"class\": \"v-img__error\"\n        }, [slots.error()])]\n      });\n    };\n    const __gradient = () => {\n      if (!props.gradient) return null;\n      return _createVNode(\"div\", {\n        \"class\": \"v-img__gradient\",\n        \"style\": {\n          backgroundImage: `linear-gradient(${props.gradient})`\n        }\n      }, null);\n    };\n    const isBooted = ref(false);\n    {\n      const stop = watch(aspectRatio, val => {\n        if (val) {\n          // Doesn't work with nextTick, idk why\n          requestAnimationFrame(() => {\n            requestAnimationFrame(() => {\n              isBooted.value = true;\n            });\n          });\n          stop();\n        }\n      });\n    }\n    useRender(() => _withDirectives(_createVNode(VResponsive, {\n      \"class\": ['v-img', {\n        'v-img--booting': !isBooted.value\n      }],\n      \"style\": {\n        width: convertToUnit(props.width === 'auto' ? naturalWidth.value : props.width)\n      },\n      \"aspectRatio\": aspectRatio.value,\n      \"aria-label\": props.alt,\n      \"role\": props.alt ? 'img' : undefined\n    }, {\n      additional: () => _createVNode(_Fragment, null, [_createVNode(__image, null, null), _createVNode(__preloadImage, null, null), _createVNode(__gradient, null, null), _createVNode(__placeholder, null, null), _createVNode(__error, null, null)]),\n      default: slots.default\n    }), [[_resolveDirective(\"intersect\"), {\n      handler: init,\n      options: props.options\n    }, null, {\n      once: true\n    }]]));\n    return {\n      currentSrc,\n      image,\n      state,\n      naturalWidth,\n      naturalHeight\n    };\n  }\n});\n//# sourceMappingURL=VImg.mjs.map"],"names":["useAspectStyles","props","computed","ratio","__name","VResponsive","genericComponent","makeDimensionProps","_ref","slots","aspectStyles","dimensionStyles","useDimension","useRender","_createVNode","_a","VImg","intersect","makeTransitionProps","event","emit","currentSrc","ref","image","state","naturalWidth","naturalHeight","normalisedSrc","aspectRatio","watch","init","val","oldVal","pollForSize","onBeforeMount","isIntersecting","SUPPORTS_INTERSECTION","lazyImg","nextTick","_b","onError","onLoad","getSrc","img","timer","timeout","poll","imgHeight","imgWidth","containClasses","__image","sources","MaybeTransition","withDirectives","vShow","__preloadImage","__placeholder","__error","__gradient","isBooted","stop","_withDirectives","convertToUnit","_Fragment","_resolveDirective"],"mappings":"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"}