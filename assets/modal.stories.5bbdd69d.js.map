{"version":3,"file":"modal.stories.5bbdd69d.js","sources":["../../packages/uikit/src/plugins/modal.ts"],"sourcesContent":["import { createVNode, nextTick, render, getCurrentInstance } from \"vue\";\n\nimport type { App, VNode } from \"vue\";\nimport {\n  FMessageModal,\n  ModalAction,\n} from \"../components/FMessageModal/FMessageModal\";\n\nexport interface MessageModalProps {\n  title?: string | VNode;\n  text?: string | VNode;\n  props?: Record<string, any>;\n  cancel?: ModalAction;\n  confirm?: ModalAction;\n  actions?: VNode;\n  type?: string;\n  container?: string;\n}\n\nexport function useModal() {\n  const instance = getCurrentInstance()!;\n\n  return instance.appContext.config.globalProperties.$uikit.modal;\n}\n\nexport type Keys = \"show\" | \"clear\";\n\nexport type ModalPlugin = Record<Keys, (options?: MessageModalProps) => void>;\n\nfunction install(app: App) {\n  let instance: VNode | null = null;\n\n  const show = (options: MessageModalProps) => {\n    if (instance) {\n      instance.component!.exposed!.close();\n    }\n\n    nextTick(() => {\n      const appendTo = document.querySelector(\n        options.container || \"[data-v-app]\"\n      );\n      const container = document.createElement(\"div\");\n      const vnode = createVNode(FMessageModal, {\n        ...options,\n        attach: container,\n        onDestroy: () => {\n          render(null, container);\n          instance = null;\n          appendTo?.removeChild(container);\n        },\n      });\n\n      vnode.appContext = app._context!;\n      render(vnode, container);\n      appendTo?.appendChild(container);\n      instance = vnode;\n\n      instance.component!.exposed!.show();\n    });\n  };\n\n  const clear = () => {\n    if (!instance) return;\n\n    instance!.component!.exposed!.close();\n  };\n\n  const modal = { show, clear };\n  const properties = app.config.globalProperties;\n\n  properties.$uikit = properties.$uikit || {};\n  properties.$uikit.modal = modal as ModalPlugin;\n}\n\nexport function Modal() {}\n\nModal.install = install;\n"],"names":["useModal","getCurrentInstance","__name"],"mappings":"grCAmBO,SAASA,GAAW,CAGzB,OAFiBC,IAED,WAAW,OAAO,iBAAiB,OAAO,KAC5D,CAJgBC,EAAAF,EAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}