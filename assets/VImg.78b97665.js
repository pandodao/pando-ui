var Q=Object.defineProperty;var i=(e,c)=>Q(e,"name",{value:c,configurable:!0});import{a as r,b,t as G,s as f,r as J,d as P,A as K,n as X,z as Y,f as F,g as Z,F as p,m as ee,v as te}from"./vue.esm-bundler.80cafc0b.js";import{p as j,m as A,g as D,u as E,e as re,t as ae}from"./color.7ba4ffe3.js";import{m as ne,u as le}from"./router.9241c2dd.js";import{m as ie,u as se}from"./rounded.b42653ce.js";import{m as oe,M as h}from"./transition.b6a16e6c.js";import{I as ue}from"./index.f2b6c1e4.js";import{Q as ce,c as de}from"./helpers.32675158.js";function ve(e){return{aspectStyles:b(()=>{const c=Number(e.aspectRatio);return c?{paddingBottom:String(1/c*100)+"%"}:void 0})}}i(ve,"useAspectStyles");const M=j({aspectRatio:[String,Number],contentClass:String,inline:Boolean,...A(),...ne()},"VResponsive"),W=D()({name:"VResponsive",props:M(),setup(e,c){let{slots:u}=c;const{aspectStyles:o}=ve(e),{dimensionStyles:R}=le(e);return E(()=>{var S;return r("div",{class:["v-responsive",{"v-responsive--inline":e.inline},e.class],style:[R.value,e.style]},[r("div",{class:"v-responsive__sizer",style:o.value},null),(S=u.additional)==null?void 0:S.call(u),u.default&&r("div",{class:["v-responsive__content",e.contentClass]},[u.default()])])}),{}}}),ge=j({alt:String,cover:Boolean,color:String,draggable:{type:[Boolean,String],default:void 0},eager:Boolean,gradient:String,lazySrc:String,options:{type:Object,default:()=>({root:void 0,rootMargin:void 0,threshold:void 0})},sizes:String,src:{type:[String,Object],default:""},crossorigin:String,referrerpolicy:String,srcset:String,position:String,...M(),...A(),...ie(),...oe()},"VImg"),ze=D()({name:"VImg",directives:{intersect:ue},props:ge(),emits:{loadstart:e=>!0,load:e=>!0,error:e=>!0},setup(e,c){let{emit:u,slots:o}=c;const{backgroundColorClasses:R,backgroundColorStyles:S}=re(G(e,"color")),{roundedClasses:O}=se(e),y=ae("VImg"),V=f(""),l=J(),n=f(e.eager?"loading":"idle"),v=f(),_=f(),s=b(()=>e.src&&typeof e.src=="object"?{src:e.src.src,srcset:e.srcset||e.src.srcset,lazySrc:e.lazySrc||e.src.lazySrc,aspect:Number(e.aspectRatio||e.src.aspect||0)}:{src:e.src,srcset:e.srcset,lazySrc:e.lazySrc,aspect:Number(e.aspectRatio||0)}),g=b(()=>s.value.aspect||v.value/_.value||0);P(()=>e.src,()=>{z(n.value!=="idle")}),P(g,(t,a)=>{!t&&a&&l.value&&m(l.value)}),K(()=>z());function z(t){if(!(e.eager&&t)&&!(ce&&!t&&!e.eager)){if(n.value="loading",s.value.lazySrc){const a=new Image;a.src=s.value.lazySrc,m(a,null)}!s.value.src||X(()=>{var a;u("loadstart",((a=l.value)==null?void 0:a.currentSrc)||s.value.src),setTimeout(()=>{var d;if(!y.isUnmounted)if((d=l.value)!=null&&d.complete){if(l.value.naturalWidth||k(),n.value==="error")return;g.value||m(l.value,null),n.value==="loading"&&C()}else g.value||m(l.value),T()})})}}i(z,"init");function C(){var t;y.isUnmounted||(T(),m(l.value),n.value="loaded",u("load",((t=l.value)==null?void 0:t.currentSrc)||s.value.src))}i(C,"onLoad");function k(){var t;y.isUnmounted||(n.value="error",u("error",((t=l.value)==null?void 0:t.currentSrc)||s.value.src))}i(k,"onError");function T(){const t=l.value;t&&(V.value=t.currentSrc||t.src)}i(T,"getSrc");let I=-1;Y(()=>{clearTimeout(I)});function m(t){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;const d=i(()=>{if(clearTimeout(I),y.isUnmounted)return;const{naturalHeight:N,naturalWidth:U}=t;N||U?(v.value=U,_.value=N):!t.complete&&n.value==="loading"&&a!=null?I=window.setTimeout(d,a):(t.currentSrc.endsWith(".svg")||t.currentSrc.startsWith("data:image/svg+xml"))&&(v.value=1,_.value=1)},"poll");d()}i(m,"pollForSize");const w=b(()=>({"v-img__img--cover":e.cover,"v-img__img--contain":!e.cover})),x=i(()=>{var d;if(!s.value.src||n.value==="idle")return null;const t=r("img",{class:["v-img__img",w.value],style:{objectPosition:e.position},src:s.value.src,srcset:s.value.srcset,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable,sizes:e.sizes,ref:l,onLoad:C,onError:k},null),a=(d=o.sources)==null?void 0:d.call(o);return r(h,{transition:e.transition,appear:!0},{default:()=>[F(a?r("picture",{class:"v-img__picture"},[a,t]):t,[[te,n.value==="loaded"]])]})},"__image"),H=i(()=>r(h,{transition:e.transition},{default:()=>[s.value.lazySrc&&n.value!=="loaded"&&r("img",{class:["v-img__img","v-img__img--preload",w.value],style:{objectPosition:e.position},src:s.value.lazySrc,alt:e.alt,crossorigin:e.crossorigin,referrerpolicy:e.referrerpolicy,draggable:e.draggable},null)]}),"__preloadImage"),$=i(()=>o.placeholder?r(h,{transition:e.transition,appear:!0},{default:()=>[(n.value==="loading"||n.value==="error"&&!o.error)&&r("div",{class:"v-img__placeholder"},[o.placeholder()])]}):null,"__placeholder"),q=i(()=>o.error?r(h,{transition:e.transition,appear:!0},{default:()=>[n.value==="error"&&r("div",{class:"v-img__error"},[o.error()])]}):null,"__error"),L=i(()=>e.gradient?r("div",{class:"v-img__gradient",style:{backgroundImage:`linear-gradient(${e.gradient})`}},null):null,"__gradient"),B=f(!1);{const t=P(g,a=>{a&&(requestAnimationFrame(()=>{requestAnimationFrame(()=>{B.value=!0})}),t())})}return E(()=>{const t=W.filterProps(e);return F(r(W,ee({class:["v-img",{"v-img--booting":!B.value},R.value,O.value,e.class],style:[{width:de(e.width==="auto"?v.value:e.width)},S.value,e.style]},t,{aspectRatio:g.value,"aria-label":e.alt,role:e.alt?"img":void 0}),{additional:()=>r(p,null,[r(x,null,null),r(H,null,null),r(L,null,null),r($,null,null),r(q,null,null)]),default:o.default}),[[Z("intersect"),{handler:z,options:e.options},null,{once:!0}]])}),{currentSrc:V,image:l,state:n,naturalWidth:v,naturalHeight:_}}});export{ze as V,W as a,ge as m};
//# sourceMappingURL=VImg.78b97665.js.map
